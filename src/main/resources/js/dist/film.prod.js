"use strict";function handler(n){var r,t,a,c,i,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=n.currentTarget,t=r.action,e.prev=3,a=new FormData(r),e.next=7,regeneratorRuntime.awrap(postForm(t,a));case 7:c=e.sent,"mark"!==(i=r.className.split("__")[0])&&"review"!==i?(o=document.querySelector("."+i+"__widen"),"comments"===i?o.innerHTML+='<div class="comment">\n                                <p class="comment__user">'.concat(c.personUsername,'</p>\n                                <p class="comment__text">').concat(c.reviewText,"</p>\n                            </div>"):"reviews"===i&&(o.innerHTML+='<div class="review">\n                                <p class="review__user">'.concat(c.personUsername,'</p>\n                                <p class="review__text">').concat(c.reviewText,'</p>\n                                <p class="review__mark">').concat(c.mark,'</p>\n                                <p class="review__rating">').concat(c.rating,'</p>\n                                <form action="/film?filmId=').concat(c.filmId,"&reviewId=").concat(c.id,'" class="review__form">\n                                    <input type="range" name="rating" id="rating" class="review__field" min="1" max="5">\n                                    <input type="submit" value="Rate review" class="review__btn">\n                                </form>\n                            </div>'),console.log(window.dispatchEvent(new Event("load"))))):"mark"===i?(o=document.querySelector("."+i+"__avg")).innerHTML="Average: "+c.toFixed(2):(o=document.querySelector("."+i+"__rating")).innerHTML=c.toFixed(2),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.log(e.t0);case 15:case"end":return e.stop()}},null,null,[[3,12]])}function postForm(n,r){var t,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.stringify(Object.fromEntries(r.entries())),console.log(n,n.includes("reviewId")),e.next=4,regeneratorRuntime.awrap(fetch(n,{method:n.includes("reviewId")?"put":"post",headers:{"Content-Type":"application/json"},body:t}));case 4:return a=e.sent,e.next=7,regeneratorRuntime.awrap(a.json());case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}})}window.addEventListener("load",function(){return["comments","mark","reviews","review"].forEach(function(e){return document.querySelectorAll("."+e+"__form").forEach(function(e){return e.addEventListener("submit",handler)})})});